!function(r,o){"function"==typeof define&&define.amd?define(["jquery","simple-module","simditor"],function(t,e){return r.returnExportsGlobal=o(t,e)}):"object"==typeof exports?module.exports=o(require("jquery"),require("simple-module"),require("simditor")):r.Simditor=o(jQuery,SimpleModule)}(this,function(o,e){var t,n={}.hasOwnProperty,r=function(t,e){function r(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};return t=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return r(t,e),t.pluginName="Dropzone",t.prototype._entered=0,t.prototype._init=function(){if(this.editor=this._module,null==this.editor.uploader)throw new Error("Can't work without 'simple-uploader' module");return o(document.body).on("dragover",function(t){return t.originalEvent.dataTransfer.dropEffect="none",t.preventDefault()}),o(document.body).on("drop",function(t){return t.preventDefault()}),this.imageBtn=this.editor.toolbar.findButton("image"),this.editor.body.on("dragover",function(t){return t.originalEvent.dataTransfer.dropEffect="copy",t.stopPropagation(),t.preventDefault()}).on("dragenter",(r=this,function(t){return 1===(r._entered+=1)&&r.show(),t.preventDefault(),t.stopPropagation()})).on("dragleave",(e=this,function(t){return(e._entered-=1)<=0&&e.hide(),t.preventDefault(),t.stopPropagation()})).on("drop",(a=this,function(t){var e,r,o,n,i,u,p;for(r=[],o=0,i=(p=t.originalEvent.dataTransfer.files).length;o<i;o++){if(e=p[o],!a.validFile(e))return alert("\u300c"+e.name+"]\u300d\u6587\u4ef6\u4e0d\u662f\u56fe\u7247\u3002"),a.hide(),!1;r.push(e)}for(n=0,u=r.length;n<u;n++)e=r[n],a.editor.uploader.upload(e,{inline:!0});return a.hide(),t.stopPropagation(),t.preventDefault()}));var a,e,r},t.prototype.show=function(){return this.imageBtn.setActive(!0)},t.prototype.hide=function(){return this.imageBtn.setActive(!1),this._entered=0},t.prototype.validFile=function(t){return-1<t.type.indexOf("image/")},t}(),Simditor.connect(t),Simditor});